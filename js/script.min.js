/*
 snake-game 2016-03-10 
*/
function quad(a){return $("[data-xcoord="+a[0]+"][data-ycoord="+a[1]+"]")}function makeFrogs(){x=Math.floor(Math.random()*(gameOptions.dimension-1-0))+1,y=Math.floor(Math.random()*(gameOptions.dimension-1-0))+1,quad([x,y]).hasClass("snake")?makeFrogs():quad([x,y]).addClass("frog").addClass(directions[Math.floor(Math.random()*directions.length)]),console.log("New Frog: "+x+","+y)}function setup(){$(".board").html("");var a=$(".board").width();$(".board").css("height",a),score=0,$("#score").text(score),isPaused=!0,direction="right",prev_direction=direction,snake=[[~~(gameOptions.dimension/2)-3,~~(gameOptions.dimension/2)],[~~(gameOptions.dimension/2)-2,~~(gameOptions.dimension/2)],[~~(gameOptions.dimension/2)-1,~~(gameOptions.dimension/2)],[~~(gameOptions.dimension/2),~~(gameOptions.dimension/2)]],head=snake.length-1;for(var b=0;b<gameOptions.dimension;b++)for(var c=0;c<gameOptions.dimension;c++)$(".board").append('<div class="quadrant" data-xcoord="'+c+'" data-ycoord="'+b+'"></div>');$(".quadrant").css({width:a/gameOptions.dimension/a*100+"%",height:a/gameOptions.dimension/a*100+"%"}),makeFrogs(),quad(snake[head]).addClass("snake snake-head").addClass(direction),quad(snake[head-1]).addClass("snake snake-body-1 flip").addClass(direction),quad(snake[head-2]).addClass("snake snake-body-main flip").addClass(direction),quad(snake[0]).addClass("snake snake-tail flip").addClass(direction)}function pauseGame(){isPaused?(progress_snake(snake),$("#start_stop").text("Pause"),isPaused=!1):(isPaused=!0,$("#start_stop").html("Resume"))}function isOver(a){return quad(a).hasClass("snake")?(console.log("Over! Bit its tail! "+a),!0):a[0]>=gameOptions.dimension||a[1]>=gameOptions.dimension||a[0]<0||a[1]<0?(console.log("Over! Crashed into the wall! "+a),!0):!1}function growSnake(a){snake.push(a),head=snake.length-1}function makeCorner(a){quad(a).addClass("snake-corner"),("up"==prev_direction&&"right"==direction||"left"==prev_direction&&"down"==direction)&&quad(a).addClass("right-corner"),("up"==prev_direction&&"left"==direction||"right"==prev_direction&&"down"==direction)&&quad(a).addClass("left-corner"),("down"==prev_direction&&"right"==direction||"left"==prev_direction&&"up"==direction)&&quad(a).addClass("down-right-corner"),("down"==prev_direction&&"left"==direction||"right"==prev_direction&&"up"==direction)&&quad(a).addClass("down-left-corner"),prev_direction=direction}function isfrog(a){return quad(a).hasClass("frog")?(score++,$("#score").text(score),!0):!1}function progress_snake(a){var b=a[head][0],c=a[head][1],d=[b,c];switch(direction){case"left":d[0]--;break;case"up":d[1]--;break;case"right":d[0]++;break;case"down":d[1]++}var e=setTimeout(function(){if(isOver(d))clearTimeout(e);else{if(isfrog(d))quad(d).removeClass("frog"),makeFrogs(),growSnake(d);else{quad(a[0]).removeClass().addClass("quadrant");for(var b=0;b<a.length-1;b++)a[b]=a[b+1];a[head]=d}quad(a[head]).removeClass().addClass("quadrant snake snake-head").addClass(direction),prev_direction!=direction&&(quad(a[head]).removeClass().addClass("quadrant snake snake-head-2").addClass(direction),makeCorner(a[head])),isFlip&&quad(a[head],a[head-1],a[head-2],a[0]).toggleClass("flip"),quad(a[head-1]).hasClass("snake-corner")?(quad(a[head]).addClass("alternate-head"),quad(a[head-1]).removeClass("snake-head, snake-head-2")):quad(a[head-1]).addClass("snake snake-body-1").removeClass("snake-head-2, snake-head"),quad(a[head-2]).hasClass("snake-corner")?quad(a[head-1]).removeClass("alternate-head"):quad(a[head-2]).addClass("snake snake-body-main").removeClass("snake-body-1").toggleClass("flip"),quad(a[0]).hasClass("snake-corner")?quad(a[0]).addClass("snake snake-tail").removeClass("snake-body-main snake-corner"):quad(a[0]).addClass("snake snake-tail").removeClass("snake-body-main snake-corner").toggleClass("flip"),isFlip=!isFlip,isPaused||progress_snake(a)}},gameOptions.speed)}function goUp(){"down"!=direction&&(prev_direction=direction,direction="up")}function goDown(){"up"!=direction&&(prev_direction=direction,direction="down")}function goLeft(){"right"!=direction&&(prev_direction=direction,direction="left")}function goRight(){"left"!=direction&&(prev_direction=direction,direction="right")}var direction,snake,head,score,prev_direction,x,y,isFlip=!0,isTurn=!1,isCorner=!1;isPaused=!0;var gameOptions={speed:100,dimension:15,theme:"theme1"},directions=["right","left","up","down"];$(document).ready(function(){setup(),window.addEventListener("resize",function(){$(".board").css("height",$(".board").width())},!1),$("#start_stop").on("tap",function(){return"Pause"==$(this).text()?void pauseGame():"Resume"==$(this).text()?void pauseGame():"Start"==$(this).text()?($(this).text("Pause"),isPaused=!1,void progress_snake(snake)):void 0}),$("#reset").on("tap",function(){$("#start_stop").text("Start"),setup()}),$("#more_frogs").on("tap",function(){makeFrogs()}),$("#left").on("tap",function(){goLeft()}),$("#up").on("tap",function(){goUp()}),$("#right").on("tap",function(){goRight()}),$("#down").on("tap",function(){goDown()}),$("#options-form-submit").on("click",function(a){$("#options-form input:checked").each(function(){gameOptions[this.name]=this.value}),console.log(gameOptions),a.preventDefault()})}),$(document).keydown(function(a){switch(a.which){case 37:isPaused&&(pauseGame(),isPaused=!1),goLeft(),$("#left").addClass("pressed");break;case 38:isPaused&&(pauseGame(),isPaused=!1),goUp(),$("#up").addClass("pressed");break;case 39:isPaused&&(pauseGame(),isPaused=!1),goRight(),$("#right").addClass("pressed");break;case 40:isPaused&&(pauseGame(),isPaused=!1),goDown(),$("#down").addClass("pressed");break;case 80:case 83:case 27:case 32:pauseGame();break;case 84:setup();break;case 77:makeFrogs();break;default:return}a.preventDefault()}),$(document).keyup(function(a){switch(a.which){case 37:$("#left").removeClass("pressed");break;case 38:$("#up").removeClass("pressed");break;case 39:$("#right").removeClass("pressed");break;case 40:$("#down").removeClass("pressed");break;default:return}a.preventDefault()});