/*
 snake-game 2016-04-04 
*/
var highscores={},snakegame=angular.module("snakegame",["backand"]).config(function(BackandProvider){BackandProvider.setAppName("snakegame"),BackandProvider.setSignUpToken("f2b442ed-11a5-4ac0-90d8-5b15a7b746c6"),BackandProvider.setAnonymousToken("e8fe4247-b670-48a4-9caa-4fa99f9820ab")}).run(function($http,Backand){var vm=this;vm.getList=function(name,sort,filter){return name="highscores",$http({method:"GET",url:Backand.getApiUrl()+"/1/objects/"+name,params:{pageSize:20,pageNumber:1,filter:filter||"",sort:sort||""}}).then(function(data){var datArr=data.data.data;console.log("Got data"),datArr.sort(function(a,b){return a.score<b.score}),console.log(datArr),$("#leaderboard ol").text(""),datArr.forEach(function(item){$("#leaderboard ol").append("<li>"+item.user+" "+item.score+"</li>")})})},vm.updateList=function(username,score){var name="highscores",today=new Date;return today=today.toISOString(),$http({method:"POST",url:Backand.getApiUrl()+"/1/objects/"+name,data:{user:username,score:score,created:today}}).then(function(){vm.getList()})},$("#postform").submit(function(e){e.preventDefault();var name=$('#postform input[name="name"]').val();$('#postform input[name="score"]').val();console.log("submit"+name),console.log(model.game.score),vm.updateList(name,model.game.score),$("#postform").trigger("reset").hide(),$(".closebtn").show()}),vm.getList()});