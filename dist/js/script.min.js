/*
 snake-game 2016-02-29 
*/
function quad(a){return $("[data-xcoord="+a[0]+"][data-ycoord="+a[1]+"]")}function makeFruits(){var a=Math.floor(Math.random()*(bd-1-0))+1,b=Math.floor(Math.random()*(bd-1-0))+1;quad([a,b]).addClass("fruit"),console.log("New Fruit: "+a+","+b)}function setup(){$(".board").html(""),$(".board").css("height",$(".board").width()),score=0,$("#score").text(score),paused=!0,direction="right",snake=[[~~(bd/2)-3,~~(bd/2)],[~~(bd/2)-2,~~(bd/2)],[~~(bd/2)-1,~~(bd/2)],[~~(bd/2),~~(bd/2)]],head=snake.length-1;for(var a=0;bd>a;a++)for(var b=0;bd>b;b++)$(".board").append('<div class="quadrant" data-xcoord="'+b+'" data-ycoord="'+a+'"></div>');makeFruits(),quad(snake[head]).addClass("snake snake-head").addClass(direction),quad(snake[head-1]).addClass("snake snake-body-1").addClass(direction),quad(snake[head-2]).addClass("snake snake-body-main").addClass(direction),quad(snake[0]).addClass("snake snake-tail").addClass(direction)}function pauseGame(){paused?(progress_snake(snake),$("#start_stop").text("Pause"),paused=!1):(paused=!0,$("#start_stop").text("Resume"))}function isOver(a){return quad(a).hasClass("snake")?(console.log("Over! Bit its tail! "+a),!0):a[0]>=bd||a[1]>=bd||a[0]<0||a[1]<0?(console.log("Over! Crashed into the wall! "+a),!0):!1}function growSnake(a){snake.push(a),head=snake.length-1}function isFruit(a){return quad(a).hasClass("fruit")?(score++,$("#score").text(score),!0):!1}function progress_snake(a){var b=a[head][0],c=a[head][1],d=[b,c];switch(direction){case"left":d[0]--;break;case"up":d[1]--;break;case"right":d[0]++;break;case"down":d[1]++}var e=setTimeout(function(){if(isOver(d))clearTimeout(e);else{if(isFruit(d))quad(d).removeClass("fruit"),makeFruits(),growSnake(d);else{quad(a[0]).removeClass().addClass("quadrant");for(var b=0;b<a.length-1;b++)a[b]=a[b+1];a[head]=d}quad(a[head]).removeClass().addClass("quadrant snake snake-head").addClass(direction),quad(a[head-1]).hasClass("snake-corner")||quad(a[head-1]).addClass("snake snake-body-1").removeClass("snake-head"),quad(a[head-2]).hasClass("snake-corner")?quad(a[head-2]).addClass("snake snake-body-main").removeClass("snake-body-1").toggleClass("flip"):quad(a[head-2]).addClass("snake snake-body-main").removeClass("snake-body-1").toggleClass("flip"),quad(a[0]).addClass("snake snake-tail").removeClass("snake-body-main").toggleClass("flip"),isFlip&&quad(a[head],a[head-1],a[head-2],a[0]).toggleClass("flip"),isFlip=!isFlip,isCorner&&(console.log(prev_direction+" : "+direction),("up"==prev_direction&&"right"==direction||"left"==prev_direction&&"down"==direction)&&quad(a[head-1]).removeClass().addClass("quadrant snake snake-corner main"),("up"==prev_direction&&"left"==direction||"right"==prev_direction&&"down"==direction)&&(quad(a[head-1]).removeClass().addClass("quadrant snake snake-corner main"),quad(a[head-1]).addClass("right")),("down"==prev_direction&&"right"==direction||"left"==prev_direction&&"up"==direction)&&(quad(a[head-1]).removeClass().addClass("quadrant snake snake-corner main"),quad(a[head-1]).addClass("left")),("down"==prev_direction&&"left"==direction||"right"==prev_direction&&"up"==direction)&&(quad(a[head-1]).removeClass().addClass("quadrant snake snake-corner main"),quad(a[head-1]).addClass("down")),isCorner=!1,prev_direction=direction),prev_direction!=direction&&(isCorner=!0),paused||progress_snake(a)}},100)}function goUp(){"down"!=direction&&(prev_direction=direction,direction="up")}function goDown(){"up"!=direction&&(prev_direction=direction,direction="down")}function goLeft(){"right"!=direction&&(prev_direction=direction,direction="left")}function goRight(){"left"!=direction&&(prev_direction=direction,direction="right")}var direction,snake,head,paused,score,prev_direction,isFlip=!0,isTurn=!1;isCorner=!1;var bd=25;$(document).ready(function(){setup(),window.addEventListener("resize",function(){$(".board").css("height",$(".board").width())},!1),$("#start_stop").on("tap",function(){return"Pause"==$(this).text()?void pauseGame():"Resume"==$(this).text()?void pauseGame():"Start"==$(this).text()?($(this).text("Pause"),paused=!1,void progress_snake(snake)):void 0}),$("#reset").on("tap",function(){$("#start_stop").text("Start"),setup()}),$("#more_frogs").on("tap",function(){makeFruits()}),$("#left").on("tap",function(){goLeft()}),$("#up").on("tap",function(){goUp()}),$("#right").on("tap",function(){goRight()}),$("#down").on("tap",function(){goDown()})}),$(document).keydown(function(a){switch(a.which){case 37:goLeft(),$("#left").addClass("pressed");break;case 38:goUp(),$("#up").addClass("pressed");break;case 39:goRight(),$("#right").addClass("pressed");break;case 40:goDown(),$("#down").addClass("pressed");break;case 80:case 27:case 32:pauseGame();break;default:return}a.preventDefault()}),$(document).keyup(function(a){switch(a.which){case 37:$("#left").removeClass("pressed");break;case 38:$("#up").removeClass("pressed");break;case 39:$("#right").removeClass("pressed");break;case 40:$("#down").removeClass("pressed");break;default:return}a.preventDefault()});